HW 2 Data Science
================
Victoria Mello (vsm2118)
October 4, 2023

# Promblem 1

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.3     ✔ readr     2.1.4
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.0
    ## ✔ ggplot2   3.4.3     ✔ tibble    3.2.1
    ## ✔ lubridate 1.9.2     ✔ tidyr     1.3.0
    ## ✔ purrr     1.0.2     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

Clean and tidy the datasets:

``` r
month_df = 
  tibble(
    month_num = 1:12,
    month_abb = month.abb,
    month = month.name)

pols = 
  read_csv("./data/pols-month.csv") |>
  separate(mon, into = c("year", "month_num", "day"), convert = TRUE) |>
  mutate(
    president = recode(prez_gop, "0" = "dem", "1" = "gop", "2" = "gop")) |>
  left_join(x = _, y = month_df) |> 
  select(year, month, everything(), -day, -starts_with("prez")) 
```

    ## Rows: 822 Columns: 9
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
    ## Joining with `by = join_by(month_num)`

``` r
snp = 
  read_csv("./data/snp.csv") |>
  separate(date, into = c("month", "day", "year"), convert = TRUE) |>
  arrange(year, month) |>
  mutate(month = month.name[month]) |>
  select(year, month, close) 
```

    ## Rows: 787 Columns: 2
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (1): close
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
unemployment = 
  read_csv("./data/unemployment.csv") |>
  rename(year = Year) |>
  pivot_longer(
    Jan:Dec, 
    names_to = "month_abb",
    values_to = "unemployment"
  ) |> 
  left_join(x = _, y = month_df) |> 
  select(year, month, unemployment)
```

    ## Rows: 68 Columns: 13
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (13): Year, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
    ## Joining with `by = join_by(month_abb)`

Merge the three datasets:

``` r
data_538 = 
  left_join(pols, snp) |>
  left_join(x = _, y = unemployment)
```

    ## Joining with `by = join_by(year, month)`
    ## Joining with `by = join_by(year, month)`

``` r
str(data_538)
```

    ## tibble [822 × 13] (S3: tbl_df/tbl/data.frame)
    ##  $ year        : num [1:822] 1947 1947 1947 1947 1947 ...
    ##  $ month       : chr [1:822] "January" "February" "March" "April" ...
    ##  $ month_num   : int [1:822] 1 2 3 4 5 6 7 8 9 10 ...
    ##  $ gov_gop     : num [1:822] 23 23 23 23 23 23 23 23 23 23 ...
    ##  $ sen_gop     : num [1:822] 51 51 51 51 51 51 51 51 51 51 ...
    ##  $ rep_gop     : num [1:822] 253 253 253 253 253 253 253 253 253 253 ...
    ##  $ gov_dem     : num [1:822] 23 23 23 23 23 23 23 23 23 23 ...
    ##  $ sen_dem     : num [1:822] 45 45 45 45 45 45 45 45 45 45 ...
    ##  $ rep_dem     : num [1:822] 198 198 198 198 198 198 198 198 198 198 ...
    ##  $ president   : chr [1:822] "dem" "dem" "dem" "dem" ...
    ##  $ month_abb   : chr [1:822] "Jan" "Feb" "Mar" "Apr" ...
    ##  $ close       : num [1:822] NA NA NA NA NA NA NA NA NA NA ...
    ##  $ unemployment: num [1:822] NA NA NA NA NA NA NA NA NA NA ...

The `pols` data has 822 observations and 11 variables and tells us about
the party affiliation distribution (democrat or republican) for
governors and senators for a given year from years 1947 to 2015. It also
tells us whether the sitting president was a democrat or republican. The
`snp` data has 787 observations and 3 variables, ranging from years 0 to
99. The `unemployment` data has 816 observations and 3 variables ranging
from years 1948 to 2015. In Januarys in or after 1975 in which a
democrat was president, the **average unemployment rate was 6.57**. The
average unemployment rate over the same time period in which a
republican was president was 6.47.

# Problem 2

``` r
# Step 1: Read and clean the Mr. Trash Wheel dataset
mr_trash_wheel <- readxl::read_excel("./trashwheel.xlsx", sheet = "Mr. Trash Wheel") %>%
  janitor::clean_names() %>%
 mutate(homes_powered=(
    (weight_tons*500)/1000),
    year = as.integer(year),
    trash_data = "mr_tw") 
```

    ## New names:
    ## • `` -> `...15`
    ## • `` -> `...16`

``` r
view(mr_trash_wheel)

# Step 2: Import, clean, and organize data for Professor Trash Wheel
professor_trash_wheel <- readxl::read_excel("./trashwheel.xlsx", sheet = "Professor Trash Wheel") %>%
   janitor::clean_names() %>% 
mutate(homes_powered=(
    (weight_tons*500)/1000),
    year = as.integer(year),
    trash_data = "professor_tw")

view(professor_trash_wheel)

# Step 3: Import, clean, and organize data for Gwynnda
gwynnda <- readxl::read_excel("./trashwheel.xlsx", sheet = "Gwynnda Trash Wheel") %>%
  janitor::clean_names() %>% 
mutate(homes_powered=(
    (weight_tons*500)/1000),
    year = as.integer(year),
    trash_data = "gwynnda_tw")

view(gwynnda)

gwynnda_july_2021 =
  gwynnda %>% 
  filter(month == "July") %>% 
  filter(year == "2021")
```

``` r
# Step 4: Combine the datasets
combined_data <- bind_rows(mr_trash_wheel, professor_trash_wheel, gwynnda) %>% 
  janitor::clean_names()
view(combined_data)
```

The collection of Mr. Trash Wheel datasets contains information about a
water-wheel vessel that removes trash from the Inner Harbor in
Baltimore, Maryland. This dataset combines data from Mr. Trash Wheel,
Professor Trash Wheel, and Gwynnda and has 849 observations and 17
variables. The dataset contains information from the years NA to NA and
includes key variables such as weight of trash collected in tons, number
of cigarette butts, and homes powered where each ton of trash equates to
on average 500 kilowatts of electricity. For available data, the total
weight of trash collected by Professor Trash Wheel is 432.52 and the
total number of cigarette butts collected by Gwynnda in July of 2021 is
1.63^{4}.

# Problem 3

``` r
# Read the datasets
MCI_baseline <- read_csv("./data_mci/MCI_baseline.csv")
```

    ## New names:
    ## Rows: 484 Columns: 6
    ## ── Column specification
    ## ──────────────────────────────────────────────────────── Delimiter: "," chr
    ## (6): ...1, Age at the study baseline, 1 = Male, 0 = Female, Years of edu...
    ## ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
    ## Specify the column types or set `show_col_types = FALSE` to quiet this message.
    ## • `` -> `...1`

``` r
mci_amyloid <- read_csv("./data_mci/mci_amyloid.csv")
```

    ## New names:
    ## Rows: 488 Columns: 6
    ## ── Column specification
    ## ──────────────────────────────────────────────────────── Delimiter: "," chr
    ## (6): Study ID, Time (in years) elapsed since the study baseline to the v...
    ## ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
    ## Specify the column types or set `show_col_types = FALSE` to quiet this message.
    ## • `NA` -> `NA...3`
    ## • `NA` -> `NA...4`
    ## • `NA` -> `NA...5`
    ## • `NA` -> `NA...6`

``` r
# Rename columns 
MCI_baseline <- MCI_baseline %>%
  rename(
    `ID` = "...1",
    `Age` = "Age at the study baseline",
    `Gender` = "1 = Male, 0 = Female",
    `Education` = "Years of education",
    `APOE4` = "1 = APOE4 carrier, 0 = APOE4 non-carrier",
    `Age_Onset_MCI` = "Age at the onset of MCI; missing if a subject remains MCI free during the follow-up period"
  )

mci_amyloid <- mci_amyloid %>%
  rename(
    `ID` = "Study ID",
    `Time_Elapsed` = "Time (in years) elapsed since the study baseline to the visit where biomarker Amyloid _ 42/40 ratio was measured",
    `Time2` = "NA...3",
    `Time4` = "NA...4",
    `Time6` = "NA...5",
    `Time8` = "NA...6"
  )
```

``` r
# Clean and tidy the demographic dataset
demographics_clean <- MCI_baseline %>%
  filter(Age_Onset_MCI != ".") %>%
  mutate(Gender = as.factor(Gender),
         APOE4 = as.factor(APOE4))

# Calculate the number of participants and those who develop MCI
num_participants <- nrow(demographics_clean)
num_participants
```

    ## [1] 98

``` r
num_mci <- sum(!is.na(demographics_clean$Age_Onset_MCI))
num_mci
```

    ## [1] 98

``` r
# Convert "." to NA in the Age column
demographics_clean$Age <- ifelse(demographics_clean$Age == ".", NA, demographics_clean$Age)

demographics_clean <- demographics_clean %>%
  mutate(Age = as.numeric(Age))
```

    ## Warning: There was 1 warning in `mutate()`.
    ## ℹ In argument: `Age = as.numeric(Age)`.
    ## Caused by warning:
    ## ! NAs introduced by coercion

``` r
# Calculate the average baseline age
avg_baseline_age <- mean(demographics_clean$Age, na.rm = TRUE)
avg_baseline_age
```

    ## [1] 65.61134

``` r
# Calculate the proportion of female APOE4 carriers
female_apoe4 <- demographics_clean$APOE4[demographics_clean$Gender == 1]
prop_women_apoe4 <- sum(female_apoe4 == 1) / length(female_apoe4)
prop_women_apoe4
```

    ## [1] 0.6078431

``` r
# Clean and tidy the biomarker dataset
mci_amyloid_clean <- mci_amyloid %>%
  gather(key = "Time", value = "Amyloid_Value", Time_Elapsed:Time8)

# Check for participants that appear in only one of the datasets
participants_demographic <- unique(demographics_clean$ID)
participants_amyloid <- unique(mci_amyloid_clean$ID)
participants_only_demographic <- setdiff(participants_demographic, participants_amyloid)
participants_only_amyloid <- setdiff(participants_amyloid, participants_demographic)

print(participants_only_demographic)
```

    ## [1] "ID"  "14"  "49"  "268"

``` r
print(participants_only_amyloid)
```

    ##   [1] "Study ID" "1"        "2"        "4"        "6"        "8"       
    ##   [7] "9"        "10"       "11"       "12"       "15"       "16"      
    ##  [13] "17"       "19"       "20"       "21"       "23"       "24"      
    ##  [19] "25"       "27"       "28"       "29"       "31"       "32"      
    ##  [25] "33"       "34"       "35"       "36"       "37"       "38"      
    ##  [31] "40"       "41"       "42"       "44"       "46"       "47"      
    ##  [37] "48"       "50"       "51"       "52"       "53"       "54"      
    ##  [43] "56"       "57"       "58"       "60"       "61"       "62"      
    ##  [49] "63"       "64"       "66"       "68"       "70"       "71"      
    ##  [55] "73"       "74"       "79"       "80"       "81"       "82"      
    ##  [61] "83"       "84"       "85"       "88"       "90"       "91"      
    ##  [67] "93"       "94"       "95"       "96"       "97"       "98"      
    ##  [73] "99"       "100"      "101"      "102"      "103"      "104"     
    ##  [79] "105"      "107"      "108"      "110"      "111"      "112"     
    ##  [85] "113"      "114"      "115"      "116"      "117"      "118"     
    ##  [91] "119"      "121"      "122"      "124"      "125"      "126"     
    ##  [97] "127"      "128"      "129"      "130"      "131"      "133"     
    ## [103] "134"      "135"      "136"      "137"      "138"      "139"     
    ## [109] "140"      "141"      "142"      "143"      "144"      "145"     
    ## [115] "147"      "148"      "150"      "151"      "152"      "153"     
    ## [121] "154"      "155"      "156"      "157"      "158"      "159"     
    ## [127] "160"      "161"      "162"      "163"      "164"      "165"     
    ## [133] "167"      "168"      "169"      "171"      "172"      "173"     
    ## [139] "174"      "175"      "176"      "178"      "180"      "181"     
    ## [145] "182"      "183"      "184"      "185"      "187"      "188"     
    ## [151] "189"      "190"      "191"      "192"      "193"      "194"     
    ## [157] "195"      "196"      "197"      "198"      "199"      "200"     
    ## [163] "201"      "203"      "204"      "205"      "206"      "207"     
    ## [169] "208"      "209"      "210"      "211"      "212"      "213"     
    ## [175] "214"      "215"      "216"      "217"      "219"      "220"     
    ## [181] "221"      "222"      "223"      "224"      "225"      "227"     
    ## [187] "228"      "231"      "232"      "233"      "235"      "236"     
    ## [193] "237"      "238"      "239"      "240"      "241"      "243"     
    ## [199] "244"      "245"      "246"      "247"      "248"      "251"     
    ## [205] "253"      "254"      "255"      "256"      "257"      "258"     
    ## [211] "259"      "260"      "261"      "262"      "263"      "264"     
    ## [217] "265"      "266"      "267"      "269"      "270"      "271"     
    ## [223] "272"      "273"      "274"      "275"      "276"      "278"     
    ## [229] "279"      "281"      "282"      "284"      "285"      "288"     
    ## [235] "290"      "291"      "293"      "294"      "295"      "296"     
    ## [241] "298"      "299"      "300"      "302"      "303"      "307"     
    ## [247] "308"      "309"      "310"      "311"      "312"      "313"     
    ## [253] "315"      "316"      "317"      "318"      "319"      "320"     
    ## [259] "321"      "322"      "324"      "325"      "326"      "327"     
    ## [265] "329"      "330"      "331"      "332"      "333"      "334"     
    ## [271] "335"      "339"      "340"      "341"      "342"      "343"     
    ## [277] "344"      "345"      "346"      "353"      "354"      "356"     
    ## [283] "357"      "358"      "359"      "360"      "361"      "362"     
    ## [289] "363"      "364"      "367"      "368"      "370"      "371"     
    ## [295] "372"      "374"      "375"      "376"      "378"      "381"     
    ## [301] "382"      "383"      "384"      "385"      "386"      "387"     
    ## [307] "388"      "390"      "391"      "392"      "393"      "394"     
    ## [313] "395"      "396"      "397"      "399"      "401"      "402"     
    ## [319] "403"      "404"      "405"      "406"      "407"      "410"     
    ## [325] "411"      "413"      "414"      "415"      "418"      "420"     
    ## [331] "421"      "422"      "425"      "427"      "428"      "429"     
    ## [337] "430"      "432"      "433"      "434"      "435"      "436"     
    ## [343] "437"      "438"      "439"      "441"      "443"      "444"     
    ## [349] "445"      "446"      "447"      "450"      "451"      "454"     
    ## [355] "455"      "456"      "457"      "458"      "459"      "460"     
    ## [361] "461"      "462"      "463"      "464"      "465"      "466"     
    ## [367] "467"      "468"      "469"      "470"      "472"      "473"     
    ## [373] "474"      "475"      "476"      "477"      "478"      "479"     
    ## [379] "480"      "481"      "482"      "483"      "484"      "485"     
    ## [385] "486"      "487"      "488"      "489"      "490"      "491"     
    ## [391] "492"      "493"      "494"      "495"

``` r
# Combine the demographic and biomarker datasets
combined_data <- demographics_clean %>%
  inner_join(mci_amyloid_clean, by = "ID")

# Export the resulting dataset as a CSV file
write_csv(combined_data, "./combined_data.csv")
```
